ğŸ“ Simple Web Server with Pattern Matching
ğŸ“ Demonstrates: Structs, pattern matching, error handling

ğŸ§± Request(method: ğŸ”¤, path: ğŸ”¤, body: ğŸ”¤)
ğŸ§± Response(status: ğŸ”¢, body: ğŸ”¤)

ğŸ§µ handle_request(req: Request) -> Response
    ğŸ”€ (req.method, req.path)
        âœ ("GET", "/")
            â†© Response(status: 200, body: "Welcome to Cymple Web Server!")
        
        âœ ("GET", path) â“ starts_with(path, "/api/")
            â†© api_handler(path)
        
        âœ ("POST", "/submit")
            ğŸ“ Process form submission
            â†© Response(status: 201, body: "Created")
        
        âœ ("GET", "/health")
            â†© Response(status: 200, body: "OK")
        
        âœ _
            â†© Response(status: 404, body: "Not Found")

ğŸ§µ api_handler(path: ğŸ”¤) -> Response
    ğŸ”€ path
        âœ "/api/status"
            â†© Response(status: 200, body: '{"status": "running"}')
        
        âœ "/api/version"
            â†© Response(status: 200, body: '{"version": "1.2"}')
        
        âœ _
            â†© Response(status: 404, body: '{"error": "Endpoint not found"}')

ğŸ§µ server()
    ğŸ’¬ "ğŸš€ Server starting on port 8080..."
    
    ğŸ” true
        ğŸ“ Accept incoming connection
        req â† accept_connection()
        
        ğŸ“ Handle request with error handling
        ğŸ§˜ guru(e)
            ğŸ”€ e.code
                âœ 500..599
                    ğŸ’¬ "âš ï¸ Server error: " + e.message
                    send_response(Response(status: 500, body: "Internal Server Error"))
                âœ _
                    ğŸ’¬ "âŒ Unexpected error: " + e.message
        
        ğŸ“ Process request
        resp â† handle_request(req)
        send_response(resp)
        ğŸ’¬ req.method + " " + req.path + " â†’ " + resp.status

ğŸ“ Start the server
server()
